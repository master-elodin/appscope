{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://appscope.dev/docs/schemas/scope_info.schema.json",
  "type": "object",
  "title": "AppScope Start message",
  "description": "Structure of the start message",
  "examples": [{"format":"ndjson","info":{"process":{"libscopever":"v1.0.0-rc0-28-g22576b94cdf8","pid":583,"ppid":582,"gid":0,"groupname":"root","uid":0,"username":"root","hostname":"5410bd79722f","procname":"curl","cmd":"curl wttr.in","id":"5410bd79722f-curl-curl wttr.in"},"configuration":{"current":{"metric":{"enable":"true","transport":{"type":"udp","host":"127.0.0.1","port":"8125","tls":{"enable":"false","validateserver":"true","cacertpath":""}},"format":{"type":"statsd","statsdprefix":"","statsdmaxlen":512,"verbosity":4},"watch":[{"type":"statsd"}]},"libscope":{"log":{"level":"warning","transport":{"type":"file","path":"/tmp/scope.log","buffering":"line"}},"configevent":"true","summaryperiod":10,"commanddir":"/tmp"},"event":{"enable":"true","transport":{"type":"tcp","host":"127.0.0.1","port":"9109","tls":{"enable":"false","validateserver":"true","cacertpath":""}},"format":{"type":"ndjson","maxeventpersec":10000,"enhancefs":"true"},"watch":[{"type":"file","name":"(\\/logs?\\/)|(\\.log$)|(\\.log[.\\d])","field":".*","value":".*"},{"type":"console","name":"(stdout)|(stderr)","field":".*","value":".*"},{"type":"http","name":".*","field":".*","value":".*","headers":[]},{"type":"net","name":".*","field":".*","value":".*"},{"type":"fs","name":".*","field":".*","value":".*"},{"type":"dns","name":".*","field":".*","value":".*"}]},"payload":{"enable":"false","dir":"/tmp"},"tags":{},"protocol":[]}},"environment":{}}}],
  "required": [
    "format",
    "info"
  ],
  "properties": {
    "authToken": {
      "$ref": "definitions/envelope.schema.json#/$defs/authToken"
    },
    "format": {
      "$ref": "definitions/envelope.schema.json#/$defs/format"
    },
    "breaker": {
      "$ref": "definitions/envelope.schema.json#/$defs/breaker"
    },
    "info": {
      "title": "info",
      "description": "info",
      "type": "object",
      "required": [
          "process",
          "configuration",
          "environment"
      ],
      "properties": {
        "process": {
          "title": "process",
          "description": "process",
          "type": "object",
          "required": [
            "libscopever",
            "pid",
            "ppid",
            "gid",
            "groupname",
            "uid",
            "username",
            "hostname",
            "procname",
            "cmd",
            "id"
          ],
          "properties": {
            "libscopever": {
              "$ref": "definitions/data.schema.json#/$defs/libscopever"
            },
            "pid": {
              "$ref": "definitions/data.schema.json#/$defs/pid"
            },
            "ppid": {
              "$ref": "definitions/data.schema.json#/$defs/ppid"
            },
            "gid": {
              "$ref": "definitions/body.schema.json#/$defs/gid"
            },
            "groupname": {
              "$ref": "definitions/body.schema.json#/$defs/groupname"
            },
            "uid": {
              "$ref": "definitions/body.schema.json#/$defs/uid"
            },
            "username": {
              "$ref": "definitions/body.schema.json#/$defs/username"
            },
            "hostname": {
              "$ref": "definitions/data.schema.json#/$defs/hostname"
            },
            "procname": {
              "$ref": "definitions/data.schema.json#/$defs/procname"
            },
            "cmd": {
              "$ref": "definitions/body.schema.json#/$defs/cmd"
            },
            "id": {
              "$ref": "definitions/data.schema.json#/$defs/id"
            }
          }
        },
        "configuration": {
          "title": "configuration",
          "description": "configuration",
          "type": "object",
          "properties": {
            "current": {
              "title": "current",
              "description": "current",
              "type": "object",
              "properties": {
                "metric": {
                  "title": "metric",
                  "description": "metric",
                  "type": "object",
                  "properties": {
                    "enable": {
                      "$ref": "definitions/data.schema.json#/$defs/enable"
                    },
                    "transport": {
                      "title": "transport",
                      "description": "transport",
                      "type": "object",
                      "properties": {
                        "type": {
                          "$ref": "definitions/data.schema.json#/$defs/transport_type"
                        },
                        "host": {
                          "$ref": "definitions/data.schema.json#/$defs/host"
                        },
                        "port": {
                          "$ref": "definitions/data.schema.json#/$defs/port_str"
                        },
                        "path": {
                          "$ref": "definitions/data.schema.json#/$defs/path"
                        },
                        "buffering": {
                          "$ref": "definitions/data.schema.json#/$defs/buffering"
                        },
                        "tls": {
                          "title": "tls",
                          "description": "tls",
                          "type": "object",
                          "properties": {
                            "enable": {
                              "$ref": "definitions/data.schema.json#/$defs/enable"
                            },
                            "validateserver": {
                              "$ref": "definitions/data.schema.json#/$defs/validateserver"
                            },
                            "cacertpath": {
                              "$ref": "definitions/data.schema.json#/$defs/cacertpath"
                            }
                          }
                        }
                      }
                    },
                    "format": {
                      "title": "format",
                      "description": "format",
                      "type": "object",
                      "properties": {
                        "type": {
                          "$ref": "definitions/data.schema.json#/$defs/format_type"
                        },
                        "statsdprefix": {
                          "$ref": "definitions/data.schema.json#/$defs/statsdprefix"
                        },
                        "statsdmaxlen": {
                          "$ref": "definitions/data.schema.json#/$defs/statsdmaxlen"
                        },
                        "verbosity": {
                          "$ref": "definitions/data.schema.json#/$defs/verbosity"
                        }
                      }
                    },
                    "watch": {
                      "title": "watch",
                      "description": "watch",
                      "type": "array",
                      "items": [
                        {
                          "properties": {
                            "type": {
                              "$ref": "definitions/data.schema.json#/$defs/watch_type_metric"
                            }
                          }
                        }
                      ]
                    }
                  }
                },
                "libscope": {
                  "title": "libscope",
                  "description": "libscope",
                  "type": "object",
                  "properties": {
                    "log": {
                      "title": "log",
                      "description": "log",
                      "type": "object",
                      "properties": {
                        "level": {
                          "$ref": "definitions/data.schema.json#/$defs/log_level"
                        },
                        "transport": {
                          "title": "transport",
                          "description": "transport",
                          "type": "object",
                          "properties": {
                            "type": {
                              "$ref": "definitions/data.schema.json#/$defs/transport_type"
                            },
                            "host": {
                              "$ref": "definitions/data.schema.json#/$defs/host"
                            },
                            "port": {
                              "$ref": "definitions/data.schema.json#/$defs/port_str"
                            },
                            "path": {
                              "$ref": "definitions/data.schema.json#/$defs/path"
                            },
                            "buffering": {
                              "$ref": "definitions/data.schema.json#/$defs/buffering"
                            },
                            "tls": {
                              "title": "tls",
                              "description": "tls",
                              "type": "object",
                              "properties": {
                                "enable": {
                                  "$ref": "definitions/data.schema.json#/$defs/enable"
                                },
                                "validateserver": {
                                  "$ref": "definitions/data.schema.json#/$defs/validateserver"
                                },
                                "cacertpath": {
                                  "$ref": "definitions/data.schema.json#/$defs/cacertpath"
                                }
                              }
                            }
                          }
                        },
                        "configevent": {
                          "$ref": "definitions/data.schema.json#/$defs/configevent"
                        },
                        "summaryperiod": {
                          "$ref": "definitions/data.schema.json#/$defs/summaryperiod"
                        },
                        "commanddir": {
                          "$ref": "definitions/data.schema.json#/$defs/commanddir"
                        }
                      }
                    }
                  }
                },
                "event": {
                  "title": "event",
                  "description": "event",
                  "type": "object",
                  "properties": {
                    "enable": {
                      "$ref": "definitions/data.schema.json#/$defs/enable"
                    },
                    "transport": {
                      "title": "transport",
                      "description": "transport",
                      "type": "object",
                      "properties": {
                        "type": {
                          "$ref": "definitions/data.schema.json#/$defs/transport_type"
                        },
                        "host": {
                          "$ref": "definitions/data.schema.json#/$defs/host"
                        },
                        "port": {
                          "$ref": "definitions/data.schema.json#/$defs/port_str"
                        },
                        "path": {
                          "$ref": "definitions/data.schema.json#/$defs/path"
                        },
                        "buffering": {
                          "$ref": "definitions/data.schema.json#/$defs/buffering"
                        },
                        "tls": {
                          "title": "tls",
                          "description": "tls",
                          "type": "object",
                          "properties": {
                            "enable": {
                              "$ref": "definitions/data.schema.json#/$defs/enable"
                            },
                            "validateserver": {
                              "$ref": "definitions/data.schema.json#/$defs/validateserver"
                            },
                            "cacertpath": {
                              "$ref": "definitions/data.schema.json#/$defs/cacertpath"
                            }
                          }
                        }
                      }
                    },
                    "format": {
                      "title": "format",
                      "description": "format",
                      "type": "object",
                      "properties": {
                        "type": {
                          "$ref": "definitions/data.schema.json#/$defs/format_type"
                        },
                        "maxeventpersec": {
                          "$ref": "definitions/data.schema.json#/$defs/maxeventpersec"
                        },
                        "enhancefs": {
                          "$ref": "definitions/data.schema.json#/$defs/enhancefs"
                        }
                      }
                    },
                    "watch": {
                      "title": "watch",
                      "description": "watch",
                      "type": "array",
                      "items": [
                        {
                          "type": "object",
                          "properties": {
                            "type": {
                              "$ref": "definitions/data.schema.json#/$defs/watch_type_event_file"
                            },
                            "name": {
                              "$ref": "definitions/data.schema.json#/$defs/name"
                            },
                            "field": {
                              "$ref": "definitions/data.schema.json#/$defs/field"
                            },
                            "value": {
                              "$ref": "definitions/data.schema.json#/$defs/value"
                            }
                          }
                        },
                        {
                          "type": "object",
                          "properties": {
                            "type": {
                              "$ref": "definitions/data.schema.json#/$defs/watch_type_event_console"
                            },
                            "name": {
                              "$ref": "definitions/data.schema.json#/$defs/name"
                            },
                            "field": {
                              "$ref": "definitions/data.schema.json#/$defs/field"
                            },
                            "value": {
                              "$ref": "definitions/data.schema.json#/$defs/value"
                            }
                          }
                        },
                        {
                          "type": "object",
                          "properties": {
                            "type": {
                              "$ref": "definitions/data.schema.json#/$defs/watch_type_event_http"
                            },
                            "name": {
                              "$ref": "definitions/data.schema.json#/$defs/name"
                            },
                            "field": {
                              "$ref": "definitions/data.schema.json#/$defs/field"
                            },
                            "value": {
                              "$ref": "definitions/data.schema.json#/$defs/value"
                            }
                          }
                        },
                        {
                          "type": "object",
                          "properties": {
                            "type": {
                              "$ref": "definitions/data.schema.json#/$defs/watch_type_event_net"
                            },
                            "name": {
                              "$ref": "definitions/data.schema.json#/$defs/name"
                            },
                            "field": {
                              "$ref": "definitions/data.schema.json#/$defs/field"
                            },
                            "value": {
                              "$ref": "definitions/data.schema.json#/$defs/value"
                            }
                          }
                        },
                        {
                          "type": "object",
                          "properties": {
                            "type": {
                              "$ref": "definitions/data.schema.json#/$defs/watch_type_event_fs"
                            },
                            "name": {
                              "$ref": "definitions/data.schema.json#/$defs/name"
                            },
                            "field": {
                              "$ref": "definitions/data.schema.json#/$defs/field"
                            },
                            "value": {
                              "$ref": "definitions/data.schema.json#/$defs/value"
                            }
                          }
                        },
                        {
                          "type": "object",
                          "properties": {
                            "type": {
                              "$ref": "definitions/data.schema.json#/$defs/watch_type_event_dns"
                            },
                            "name": {
                              "$ref": "definitions/data.schema.json#/$defs/name"
                            },
                            "field": {
                              "$ref": "definitions/data.schema.json#/$defs/field"
                            },
                            "value": {
                              "$ref": "definitions/data.schema.json#/$defs/value"
                            }
                          }
                        }
                      ]
                    }
                  }
                },
                "payload": {
                  "title": "payload",
                  "description": "payload",
                  "type": "object",
                  "properties": {
                    "enable": {
                      "$ref": "definitions/data.schema.json#/$defs/enable"
                    },
                    "dir": {
                      "$ref": "definitions/data.schema.json#/$defs/dir"
                    }
                  }
                },
                "tags": {
                  "title": "tags",
                  "description": "tags",
                  "type": "object"
                },
                "protocol": {
                  "title": "protocol",
                  "description": "protocol",
                  "type": "array",
                  "items": [
                    {
                      "type": "object",
                      "properties": {
                        "name": {
                          "$ref": "definitions/data.schema.json#/$defs/name"
                        },
                        "regex": {
                          "$ref": "definitions/data.schema.json#/$defs/regex"
                        },
                        "binary": {
                          "$ref": "definitions/data.schema.json#/$defs/binary"
                        },
                        "len": {
                          "$ref": "definitions/data.schema.json#/$defs/len"
                        },
                        "detect": {
                          "$ref": "definitions/data.schema.json#/$defs/detect"
                        },
                        "payload": {
                          "$ref": "definitions/data.schema.json#/$defs/payload"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "environment": {
          "title": "environment",
          "description": "environment",
          "type": "object"
        }
      }
    }
  },
  "additionalProperties": false
}
